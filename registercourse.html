<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ØªØ³Ø¬ÙŠÙ„ Ù…ÙˆØ§Ø¯ Ù„Ù„Ø·Ù„Ø§Ø¨ - Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø³Ù„Ø§Ù… Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;500;700;900&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary: #004b8f;
      --primary-dark: #01233f;
      --accent: #0ea5e9;
      --gold: #fbbf24;
      --bg: #020617;
      --muted: #9ca3af;
      --card-bg: rgba(15,23,42,0.85);
      --border-soft: rgba(148,163,184,0.5);
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      font-family: "Cairo", sans-serif;
      direction: rtl;
      overflow-x: hidden;
      touch-action: pan-y;
      scroll-behavior: smooth;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    html::-webkit-scrollbar,
    body::-webkit-scrollbar {
      width: 0;
      height: 0;
    }

    body {
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 14px 10px 18px;
      position: relative;
      overflow-x: hidden;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior-x: contain;
      background: radial-gradient(circle at top left, #0f172a 0, #020617 40%, #000 100%);
    }

    body::before,
    body::after {
      content: "";
      position: absolute;
      border-radius: 999px;
      filter: blur(42px);
      opacity: 0.55;
      pointer-events: none;
      z-index: 0;
    }

    body::before {
      width: 360px;
      height: 360px;
      background: radial-gradient(circle at center, rgba(56,189,248,0.65), transparent 60%);
      top: -120px;
      right: -60px;
      animation: floatBlob1 16s ease-in-out infinite alternate;
    }

    body::after {
      width: 320px;
      height: 320px;
      background: radial-gradient(circle at center, rgba(250,204,21,0.5), transparent 60%);
      bottom: -140px;
      left: -80px;
      animation: floatBlob2 18s ease-in-out infinite alternate;
    }

    @keyframes floatBlob1 {
      0% { transform: translate3d(0,0,0); }
      100% { transform: translate3d(-20px, 30px, 0); }
    }

    @keyframes floatBlob2 {
      0% { transform: translate3d(0,0,0); }
      100% { transform: translate3d(25px,-20px,0); }
    }

    .header-bar {
      position: relative;
      z-index: 2;
      width: 100%;
      max-width: 960px;
      margin: 0 auto 10px;
      padding: 6px 14px;
      border-radius: 999px;
      background: radial-gradient(circle at top left, rgba(15,23,42,0.98), rgba(15,23,42,0.92));
      border: 1px solid rgba(148,163,184,0.5);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      box-shadow:
        0 0 0 1px rgba(15,23,42,1),
        0 18px 38px rgba(15,23,42,0.9);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .header-logo {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      overflow: hidden;
      border: 1px solid rgba(148,163,184,0.8);
      box-shadow:
        0 0 0 1px rgba(15,23,42,1),
        0 10px 22px rgba(15,23,42,0.9);
      background: #020617;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .header-logo img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .header-text-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .header-text-main .uni-name {
      font-size: 0.92rem;
      font-weight: 800;
      color: #f9fafb;
      letter-spacing: 0.01em;
    }

    .header-text-main .uni-sub {
      font-size: 0.7rem;
      color: #9ca3af;
    }

    .header-tag {
      font-size: 0.72rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: radial-gradient(circle at top, rgba(56,189,248,0.24), rgba(15,23,42,0.96));
      border: 1px solid rgba(148,163,184,0.75);
      color: #e5e7eb;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      white-space: nowrap;
    }

    .header-tag::before {
      content: "";
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34,197,94,0.22);
    }

    .shell {
      position: relative;
      z-index: 1;
      width: 100%;
      max-width: 960px;
      margin: 0 auto;
      background: radial-gradient(circle at top left, rgba(15,23,42,0.98), rgba(15,23,42,0.88));
      border-radius: 26px;
      box-shadow:
        0 0 0 1px rgba(148,163,184,0.45),
        0 24px 70px rgba(15,23,42,0.85);
      overflow: hidden;
      display: grid;
      grid-template-columns: minmax(0,1.35fr) minmax(0,1fr);
      backdrop-filter: blur(22px);
      -webkit-backdrop-filter: blur(22px);
      border: 1px solid rgba(148,163,184,0.35);
    }

    .shell::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg,
        rgba(148,163,184,0.28),
        transparent 35%,
        rgba(56,189,248,0.12),
        transparent 75%);
      pointer-events: none;
      mix-blend-mode: soft-light;
    }

    .top-bar {
      grid-column: 1 / -1;
      padding: 10px 18px 10px;
      background: linear-gradient(135deg, #0f172a, #020617);
      border-bottom: 1px solid rgba(148,163,184,0.55);
      color: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      position: relative;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .top-bar::after {
      content: "";
      position: absolute;
      inset-inline-start: -40px;
      inset-block-end: -60px;
      width: 260px;
      height: 260px;
      background: radial-gradient(circle at center, rgba(56,189,248,0.5), transparent 65%);
      opacity: 0.18;
      pointer-events: none;
    }

    .top-left {
      display: flex;
      align-items: center;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .logo-circle {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      background: radial-gradient(circle at top, rgba(56,189,248,0.25), rgba(15,23,42,0.9));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      box-shadow:
        0 0 0 1px rgba(148,163,184,0.6),
        0 10px 22px rgba(15,23,42,0.9);
      animation: floatIcon 3s ease-in-out infinite;
    }

    .top-text h1 {
      margin: 0;
      font-size: 1.05rem;
      font-weight: 800;
      letter-spacing: 0.02em;
      color: #f9fafb;
    }

    .top-text p {
      margin: 0;
      font-size: 0.75rem;
      opacity: 0.85;
      color: #cbd5f5;
    }

    .chip {
      position: relative;
      z-index: 1;
      font-size: 0.78rem;
      padding: 5px 12px;
      border-radius: 999px;
      background: radial-gradient(circle at top left, rgba(56,189,248,0.25), rgba(15,23,42,0.9));
      border: 1px solid rgba(148,163,184,0.7);
      color: #e5e7eb;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 10px 22px rgba(15,23,42,0.85);
    }

    .chip::before {
      content: "";
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 6px rgba(34,197,94,0.18);
    }

    .form-pane {
      position: relative;
      padding: 22px 20px 20px;
      border-left: 1px solid rgba(31,41,55,0.85);
      background: linear-gradient(145deg, rgba(15,23,42,0.96), rgba(15,23,42,0.9));
      z-index: 1;
    }

    .form-pane::before {
      content: "";
      position: absolute;
      inset-inline-end: -80px;
      inset-block-start: -60px;
      width: 200px;
      height: 200px;
      border-radius: 999px;
      background: radial-gradient(circle at center, rgba(59,130,246,0.3), transparent 65%);
      opacity: 0.4;
      pointer-events: none;
    }

    .form-title {
      margin: 10px 0 8px;
      font-size: 1.22rem;
      font-weight: 800;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #f9fafb;
    }

    .form-title span.icon {
      font-size: 1.4rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 30px;
      height: 30px;
      border-radius: 999px;
      background: radial-gradient(circle at top, rgba(34,197,94,0.18), rgba(21,128,61,0.95));
      box-shadow:
        0 0 0 1px rgba(34,197,94,0.55),
        0 10px 20px rgba(22,163,74,0.65);
    }

    .subtitle {
      margin: 0 0 12px;
      font-size: 0.82rem;
      color: var(--muted);
    }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 10px;
      margin-bottom: 6px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    label {
      font-size: 0.8rem;
      color: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    label::after {
      content: attr(data-hint);
      font-size: 0.68rem;
      color: #64748b;
      font-weight: 400;
    }

    input,
    select {
      width: 100%;
      padding: 9px 11px;
      border-radius: 12px;
      border: 1px solid rgba(51,65,85,0.95);
      background: radial-gradient(circle at top, rgba(15,23,42,0.98), rgba(15,23,42,0.92));
      font-size: 0.9rem;
      transition: 0.22s ease;
      font-family: "Cairo", sans-serif;
      color: #e5e7eb;
      box-shadow:
        inset 0 0 0 1px rgba(15,23,42,0.9),
        0 10px 18px rgba(15,23,42,0.85);
    }

    input::placeholder {
      color: #6b7280;
    }

    input:focus,
    select:focus {
      border-color: rgba(56,189,248,0.9);
      box-shadow:
        0 0 0 1px rgba(56,189,248,0.9),
        0 0 0 6px rgba(56,189,248,0.1);
      outline: none;
      background: radial-gradient(circle at top, rgba(15,23,42,1), rgba(15,23,42,0.94));
    }

    input[readonly] {
      background: radial-gradient(circle at top, rgba(15,23,42,0.95), rgba(15,23,42,0.9));
      border-style: dashed;
      border-color: rgba(75,85,99,0.9);
      cursor: default;
      color: #9ca3af;
    }

    .actions {
      margin-top: 14px;
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    button {
      padding: 9px 24px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #f9fafb;
      font-size: 0.95rem;
      cursor: pointer;
      font-weight: 800;
      transition: transform 0.18s ease, box-shadow 0.18s ease, filter 0.18s ease;
      box-shadow:
        0 0 0 1px rgba(22,163,74,0.7),
        0 18px 35px rgba(22,163,74,0.8);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      letter-spacing: 0.02em;
      position: relative;
      overflow: hidden;
    }

    button::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, rgba(255,255,255,0.22), transparent 40%, transparent 60%, rgba(255,255,255,0.18));
      opacity: 0;
      transform: translateX(-40%);
      transition: opacity 0.3s ease, transform 0.45s ease;
    }

    button span.btn-icon {
      font-size: 1.1rem;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow:
        0 0 0 1px rgba(22,163,74,0.85),
        0 22px 40px rgba(22,163,74,1);
      filter: brightness(1.05);
    }

    button:hover::after {
      opacity: 1;
      transform: translateX(30%);
    }

    button:active {
      transform: translateY(0);
      box-shadow:
        0 0 0 1px rgba(22,163,74,0.85),
        0 12px 24px rgba(21,128,61,0.95);
    }

    .hint {
      font-size: 0.75rem;
      color: var(--muted);
      max-width: 240px;
    }

    .msg {
      margin-top: 10px;
      font-weight: 700;
      font-size: 0.9rem;
      min-height: 1.2rem;
      transition: 0.18s ease;
    }

    .debug-label {
      margin-top: 10px;
      font-size: 0.74rem;
      color: #9ca3af;
    }

    #raw {
      margin-top: 6px;
      background: #020617;
      color: #22c55e;
      padding: 7px 9px;
      font-size: 11px;
      max-height: 110px;
      overflow: auto;
      border-radius: 10px;
      direction: ltr;
      text-align: left;
      border: 1px dashed rgba(55,65,81,0.9);
    }

    .info-pane {
      position: relative;
      padding: 18px 18px 20px;
      background: radial-gradient(circle at top, rgba(15,23,42,0.96), rgba(15,23,42,0.94));
      overflow: hidden;
      z-index: 1;
    }

    .info-pane::before {
      content: "";
      position: absolute;
      inset-inline-start: -80px;
      inset-block-start: -60px;
      width: 220px;
      height: 220px;
      border-radius: 999px;
      background: radial-gradient(circle at center, rgba(56,189,248,0.32), transparent 65%);
      opacity: 0.45;
      pointer-events: none;
    }

    .info-pane::after {
      content: "";
      position: absolute;
      inset-inline-end: -60px;
      inset-block-end: -80px;
      width: 200px;
      height: 200px;
      border-radius: 999px;
      background: radial-gradient(circle at center, rgba(250,204,21,0.3), transparent 65%);
      opacity: 0.45;
      pointer-events: none;
    }

    .badge {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 11px;
      border-radius: 999px;
      font-size: 0.78rem;
      background: radial-gradient(circle at top left, rgba(15,23,42,0.95), rgba(15,23,42,0.9));
      border: 1px solid rgba(148,163,184,0.75);
      color: #e5e7eb;
      margin-bottom: 10px;
      box-shadow:
        0 0 0 1px rgba(15,23,42,1),
        0 14px 28px rgba(15,23,42,0.95);
      z-index: 1;
    }

    .badge::before {
      content: "";
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 5px rgba(34,197,94,0.24);
    }

    .info-title {
      position: relative;
      margin: 2px 0 8px;
      font-size: 1.02rem;
      font-weight: 800;
      color: #f9fafb;
      z-index: 1;
    }

    .info-text {
      position: relative;
      margin: 0 0 10px;
      font-size: 0.8rem;
      color: #cbd5f5;
      z-index: 1;
    }

    .bullet-list {
      position: relative;
      margin: 4px 0 10px;
      padding: 0;
      list-style: none;
      font-size: 0.8rem;
      color: #e5e7eb;
      z-index: 1;
    }

    .bullet-list li {
      display: flex;
      align-items: flex-start;
      gap: 7px;
      margin-bottom: 6px;
    }

    .dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #0ea5e9;
      margin-top: 4px;
      box-shadow: 0 0 0 4px rgba(14,165,233,0.22);
      flex-shrink: 0;
    }

    .mini-label {
      position: relative;
      font-size: 0.74rem;
      color: #9ca3af;
      margin-top: 6px;
      z-index: 1;
    }

    .pill-row {
      position: relative;
      display: flex;
      flex-wrap: wrap;
      gap: 7px;
      margin-top: 6px;
      z-index: 1;
    }

    .pill {
      font-size: 0.72rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: radial-gradient(circle at top, rgba(15,23,42,0.95), rgba(15,23,42,0.9));
      border: 1px solid rgba(148,163,184,0.75);
      color: #e5e7eb;
      box-shadow:
        0 0 0 1px rgba(15,23,42,1),
        0 10px 22px rgba(15,23,42,0.9);
    }

    @keyframes floatIcon {
      0%,100% { transform: translateY(0); }
      50%     { transform: translateY(-3px); }
    }

    @media (max-width: 800px) {
      .shell {
        grid-template-columns: 1fr;
        border-radius: 22px;
      }

      .form-pane {
        border-left: none;
        border-top: 1px solid rgba(31,41,55,0.85);
      }

      .info-pane {
        order: -1;
      }
    }

    @media (max-width: 550px) {
      body {
        padding: 8px 6px 10px;
        background: #020617;
      }

      body::before,
      body::after {
        display: none !important;
      }

      .header-bar,
      .shell,
      .form-pane,
      .info-pane,
      .top-bar {
        backdrop-filter: none !important;
        -webkit-backdrop-filter: none !important;
      }

      * {
        box-shadow: none !important;
      }

      button {
        transform: none !important;
        transition: none !important;
      }

      button:hover,
      button:active {
        transform: none !important;
      }

      .header-bar {
        max-width: 100%;
        border-radius: 16px;
        padding: 7px 10px;
      }

      .shell {
        max-width: 100%;
        border-radius: 18px;
      }

      .top-bar {
        padding: 9px 12px 7px;
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }

      .form-pane,
      .info-pane {
        padding: 14px 12px 16px;
      }

      .row {
        grid-template-columns: 1fr;
        gap: 10px;
      }

      button {
        width: 100%;
        justify-content: center;
      }

      .actions {
        flex-direction: column;
        align-items: stretch;
      }

      .hint {
        max-width: 100%;
      }

      .header-text-main .uni-name {
        font-size: 0.88rem;
      }

      .header-left {
        gap: 8px;
      }

      .header-tag {
        display: none;
      }
    }

    .debug-label,
    #raw,
    .debug-bar {
      display: none !important;
    }
  </style>
</head>

<body>

<div class="header-bar">
  <div class="header-left">
    <div class="header-logo">
      <img src="aiu-logo.png" alt="Ø´Ø¹Ø§Ø± Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø³Ù„Ø§Ù… Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©">
    </div>
    <div class="header-text-main">
      <div class="uni-name">Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø³Ù„Ø§Ù… Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©</div>
      <div class="uni-sub">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø±Ø±Ø§Øª Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</div>
    </div>
  </div>
    <div class="header-tag">Ù….Ø£ÙŠÙˆØ¨ Ø§Ù„Ø­ÙˆØ§Øª</div>
  <div class="header-tag">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©</div>
</div>

<div class="shell">
  <div class="top-bar">
    <div class="top-left">
      <div class="logo-circle">ğŸ“</div>
      <div class="top-text">
        <h1>ØªØ³Ø¬ÙŠÙ„ Ù…ÙˆØ§Ø¯ Ù„Ù„Ø·Ù„Ø§Ø¨</h1>
        <p>    ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© Ù„Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ Ø§Ù„ÙØµÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ.</p>
      </div>
    </div>
    <div class="chip">ÙˆØ­Ø¯Ø© Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</div>
    <div class="chip">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©</div>
  </div>

  <div class="form-pane">
    <h2 class="form-title">
      <span class="icon">â•</span>
      <span>Ø¥Ø¶Ø§ÙØ© ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</span>
    </h2>
<p class="subtitle" style="color:#F4C46A;">
  Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø©ØŒ Ø«Ù… Ø§Ø¶ØºØ· ØªØ³Ø¬ÙŠÙ„.
</p>

    <div class="row">
      <div class="field">
        <label for="sid">Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯</label>
        <input list="studentsList" type="text" id="sid" placeholder="Ù…Ø«Ø§Ù„: 20251234 Ø£Ùˆ Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">
        <datalist id="studentsList"></datalist>
      </div>
      <div class="field">
        <label for="studentName">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</label>
        <input type="text" id="studentName" placeholder="Ø³ÙŠØ¸Ù‡Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„/Ø§Ø®ØªÙŠØ§Ø± Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯" readonly>
      </div>
    </div>

    <div class="row">
      <div class="field">
        <label for="code">Ø±Ù…Ø² Ø§Ù„Ù…Ø§Ø¯Ø© (Ø§Ø®ØªØ± Ø£Ùˆ Ø§ÙƒØªØ¨ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©)</label>
        <input list="courseList" type="text" id="code" placeholder="Ù…Ø«Ø§Ù„: IT101 Ø£Ùˆ Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">
        <datalist id="courseList"></datalist>
      </div>
      <div class="field">
        <label for="courseName">Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</label>
        <input type="text" id="courseName" placeholder="Ø³ÙŠØ¸Ù‡Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø±Ù…Ø²" readonly>
      </div>
    </div>

    <div class="field">
      <label for="semester">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
      <input type="text" id="semester" value="Ø®Ø±ÙŠÙ 2026/2025" readonly>
    </div>

    <div class="actions">
      <button onclick="registerCourse()">
        <span class="btn-icon">âœ…</span>
        <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø© Ù„Ù„Ø·Ø§Ù„Ø¨</span>
      </button>
      <span class="hint">Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ ÙˆØ±Ù…Ø² Ø§Ù„Ù…Ø§Ø¯Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ†Ø§ Ù…Ù† Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø¹Ø±Ù‘ÙØ©.</span>
    </div>

    <p id="msg" class="msg"></p>

    <div class="debug-label">ğŸ” Ø±Ø¯ Ø§Ù„Ù€ API (Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙ‚Ø·):</div>
    <pre id="raw"></pre>
  </div>

  <div class="info-pane">
    <div class="badge">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ</div>
    <h3 class="info-title">Ø¯ÙˆØ± ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯</h3>
    <p class="info-text">
      Ù…Ù† Ø®Ù„Ø§Ù„ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ÙŠØªÙ… Ø±Ø¨Ø· ÙƒÙ„ Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ù…Ù‚Ø±Ø±Ø§Øª Ø§Ù„ØªÙŠ ÙŠØ¯Ø±Ø³Ù‡Ø§ ÙÙŠ ÙØµÙ„ Ù…Ø¹ÙŠÙ†ØŒ
      ÙˆÙ‡Ùˆ Ù…Ø§ ÙŠØ³Ù…Ø­ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ø¨Ù€:
    </p>

    <ul class="bullet-list">
      <li><span class="dot"></span>Ø¹Ø±Ø¶ Ù…ÙˆØ§Ø¯ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù….</li>
      <li><span class="dot"></span>Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙŠ ÙƒÙ„ Ù…Ø§Ø¯Ø© ÙÙŠ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±.</li>
      <li><span class="dot"></span>ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ø¨Ø¡ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ù„ÙƒÙ„ Ø·Ø§Ù„Ø¨.</li>
    </ul>

    <div class="mini-label">Ø£Ù…Ø«Ù„Ø© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ:</div>
    <div class="pill-row">
      <div class="pill">Ø®Ø±ÙŠÙ 2025/2026</div>
      <div class="pill">Ø±Ø¨ÙŠØ¹ 2025/2026</div>
      <div class="pill">ØµÙŠÙÙŠ 2025</div>
    </div>

    <div class="mini-label" style="margin-top: 12px;">Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù‘ÙÙ„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙØµÙ„:</div>
    <ul class="bullet-list" id="studentCourses">
      <li><span class="dot"></span>Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„Ø©.</li>
    </ul>
  </div>
</div>

<script>           
  const API_URL = "https://script.google.com/macros/s/AKfycbxSXzoccORX5DP_MwJXg13WPHDBV5vuuh3v0pX8Lch0xYX4tLrF8JjlVpdGpeQLt_7RKA/exec";

  let allCourses = [];
  let allStudents = [];

  function getCurrentUser() {
    return localStorage.getItem("USERNAME") || "";
  }

  function normalizeCode(raw) {
    if (!raw) return "";
    let val = String(raw).trim();

    const sep = " - ";
    const idx = val.indexOf(sep);
    if (idx !== -1) {
      val = val.slice(0, idx).trim();
    }

    return val.toUpperCase();
  }

  async function loadCoursesList() {
    try {
      const res  = await fetch(`${API_URL}?action=courseSummary`);
      const text = await res.text();
      let data;
      try { data = JSON.parse(text); } catch(e){ console.log("Course list not JSON:", text); return;}

      if (!data.summary || !Array.isArray(data.summary)) return;

      allCourses = data.summary;
      const dl = document.getElementById("courseList");
      dl.innerHTML = "";

      allCourses.forEach(c => {
        if (!c.code && !c.name) return;
        const opt = document.createElement("option");
        opt.value = `${c.code} - ${c.name}`;
        dl.appendChild(opt);
      });
    } catch (e) {
      console.error("Error loading courses:", e);
    }
  }

  async function loadStudentsList() {
    try {
      const res  = await fetch(`${API_URL}?action=studentsSummary`);
      const text = await res.text();
      let data;
      try { data = JSON.parse(text); } catch(e){ console.log("Students list not JSON:", text); return;}

      if (!data.students || !Array.isArray(data.students)) return;

      allStudents = data.students;
      const dl = document.getElementById("studentsList");
      dl.innerHTML = "";

      allStudents.forEach(s => {
        if (!s.id && !s.full_name) return;
        const opt = document.createElement("option");
        opt.value = `${s.id} - ${s.full_name}`;
        dl.appendChild(opt);
      });

    } catch (e) {
      console.error("Error loading students:", e);
    }
  }

  function validateStudentFromInput() {
    const sidInput    = document.getElementById("sid");
    const studentName = document.getElementById("studentName");
    const msg         = document.getElementById("msg");

    let rawValue = sidInput.value.trim();
    studentName.value = "";
    msg.textContent = "";

    if (!rawValue) {
      const listEl = document.getElementById("studentCourses");
      if (listEl) {
        listEl.innerHTML = `<li><span class="dot"></span>Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„Ø©.</li>`;
      }
      return;
    }

    const dashIndex = rawValue.indexOf("-");
    if (dashIndex !== -1) {
      rawValue = rawValue.slice(0, dashIndex).trim();
      sidInput.value = rawValue;
    }

    if (!allStudents || allStudents.length === 0) {
      msg.style.color = "red";
      msg.textContent = "âš  Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø©.";
      return;
    }

    const found = allStudents.find(s => String(s.id).trim() === rawValue);

    if (found) {
      studentName.value = found.full_name || "";
      msg.style.color = "#16a34a";
      msg.textContent = "âœ” Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…ÙˆØ¬ÙˆØ¯ Ø¶Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø©";
      loadStudentCourses();
    } else {
      msg.style.color = "red";
      msg.textContent = "âŒ Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¶Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø© Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†";
      sidInput.value = "";

      const listEl = document.getElementById("studentCourses");
      if (listEl) {
        listEl.innerHTML = `<li><span class="dot"></span>Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</li>`;
      }
    }
  }

  function updateCourseNameFromInput() {
    const codeInput   = document.getElementById("code");
    const courseName  = document.getElementById("courseName");
    const rawCode     = codeInput.value;
    const cleanCode   = normalizeCode(rawCode);

    courseName.value = "";

    if (!cleanCode || allCourses.length === 0) return;

    const found = allCourses.find(c => String(c.code).trim().toUpperCase() === cleanCode);
    if (found) {
      courseName.value = found.name || "";
    }
  }

  async function loadStudentCourses() {
    const sidInput = document.getElementById("sid");
    const semInput = document.getElementById("semester");
    const listEl   = document.getElementById("studentCourses");

    if (!listEl) return;

    let sidRaw = sidInput.value.trim();
    if (!sidRaw) {
      listEl.innerHTML = `<li><span class="dot"></span>Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„Ø©.</li>`;
      return;
    }

    const dashIndex = sidRaw.indexOf("-");
    if (dashIndex !== -1) {
      sidRaw = sidRaw.slice(0, dashIndex).trim();
    }
    const sid = sidRaw;
    const sem = semInput.value.trim();

    listEl.innerHTML = `<li><span class="dot"></span>â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…ÙˆØ§Ø¯ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù„Ù‡Ø°Ø§ Ø§Ù„ÙØµÙ„...</li>`;

    try {
      const url  = `${API_URL}?action=getStudent&id=${encodeURIComponent(sid)}`;
      const res  = await fetch(url);
      const text = await res.text();

      let data;
      try { data = JSON.parse(text); } catch (e) {
        console.error("Student data not JSON:", text);
        listEl.innerHTML = `<li><span class="dot"></span>âš  Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨.</li>`;
        return;
      }

      if (data.error === "STUDENT_NOT_FOUND") {
        listEl.innerHTML = `<li><span class="dot"></span>Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</li>`;
        return;
      }

      const all = Array.isArray(data.courses) ? data.courses : [];
      let filtered = all;

      if (sem) {
        filtered = all.filter(c => String(c.semester || "").trim() === sem);
      }

      if (!filtered.length) {
        listEl.innerHTML = `<li><span class="dot"></span>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¯ Ù…Ø³Ø¬Ù‘Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙØµÙ„.</li>`;
        return;
      }

      listEl.innerHTML = "";
      filtered.forEach(c => {
        const li = document.createElement("li");
        li.innerHTML = `<span class="dot"></span><span>${c.code || ""} - <strong>${c.name || ""}</strong></span>`;
        listEl.appendChild(li);
      });

    } catch (err) {
      console.error(err);
      listEl.innerHTML = `<li><span class="dot"></span>âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ API Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯.</li>`;
    }
  }

  async function registerCourse() {
    const sidInput    = document.getElementById('sid');
    const codeInput   = document.getElementById('code');
    const semInput    = document.getElementById('semester');
    const msg         = document.getElementById('msg');
    const raw         = document.getElementById('raw');
    const studentName = document.getElementById('studentName');
    const courseName  = document.getElementById('courseName');

    let sidRaw  = sidInput.value.trim();
    const sem   = semInput.value.trim();
    const cleanCode = normalizeCode(codeInput.value);

    const dashIndex = sidRaw.indexOf("-");
    if (dashIndex !== -1) {
      sidRaw = sidRaw.slice(0, dashIndex).trim();
      sidInput.value = sidRaw;
    }

    const sid = sidRaw;
    const currentUser = getCurrentUser();

    msg.textContent = "";
    msg.style.color = "red";
    raw.textContent = "";

    if (!sid || !cleanCode || !sem) {
      msg.textContent = "âš  Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ØŒ Ø±Ù…Ø² Ø§Ù„Ù…Ø§Ø¯Ø©ØŒ ÙˆØ§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ù…Ø·Ù„ÙˆØ¨Ø©";
      return;
    }

    if (!allStudents || allStudents.length === 0) {
      msg.textContent = "âš  Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø©ØŒ Ø­Ø¯Ù‘Ø« Ø§Ù„ØµÙØ­Ø©.";
      return;
    }
    const stu = allStudents.find(s => String(s.id).trim() === sid);
    if (!stu) {
      msg.textContent = "âŒ Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¶Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø©ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„.";
      return;
    }
    if (!studentName.value) {
      studentName.value = stu.full_name || "";
    }

    if (!allCourses || allCourses.length === 0) {
      msg.textContent = "âš  Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ØŒ Ø­Ø¯Ù‘Ø« Ø§Ù„ØµÙØ­Ø©.";
      return;
    }
    const course = allCourses.find(c => String(c.code).trim().toUpperCase() === cleanCode);
    if (!course) {
      msg.textContent = "âš  Ø±Ù…Ø² Ø§Ù„Ù…Ø§Ø¯Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯.";
      return;
    }
    if (!courseName.value) {
      courseName.value = course.name || "";
    }

    const url = `${API_URL}?action=registerCourse`
      + `&sid=${encodeURIComponent(sid)}`
      + `&code=${encodeURIComponent(cleanCode)}`
      + `&semester=${encodeURIComponent(sem)}`
      + `&user=${encodeURIComponent(currentUser)}`;

    try {
      const res  = await fetch(url);
      const text = await res.text();
      raw.textContent = text;

      let data;
      try { data = JSON.parse(text); } catch(e){
        msg.textContent = "Ø§Ù„Ø±Ø¯ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ù„ÙŠØ³ JSONØŒ Ø±Ø§Ø¬Ø¹ Code.gs Ø£Ùˆ Ø§Ù„Ù†Ø´Ø±.";
        return;
      }

      if (data.status === "OK") {
        msg.style.color = "green";
        msg.textContent = "âœ” ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø© Ù„Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­";
        codeInput.value   = "";
        courseName.value  = "";
        loadStudentCourses();

      } else if (data.status === "MISSING_FIELDS") {
        msg.textContent = "âš  Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ ÙˆØ±Ù…Ø² Ø§Ù„Ù…Ø§Ø¯Ø©.";

      } else if (data.status === "STUDENT_NOT_FOUND") {
        msg.textContent = "âŒ Ø±Ù‚Ù… Ø§Ù„Ù‚ÙŠØ¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨ (Students).";

      } else if (data.status === "COURSE_NOT_FOUND") {
        msg.textContent = "âŒ Ø±Ù…Ø² Ø§Ù„Ù…Ø§Ø¯Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ÙˆØ§Ø¯ (Courses).";

      } else if (data.status === "ALREADY_REGISTERED") {
        msg.textContent = "âš  Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø© Ù…Ø³Ø¬Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ù‚Ø¨Ù„ (Ø±Ø§Ù‡ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù†Ø²Ù„Ù‡Ø§).";

      // â­ Ø£Ø³Ø¨Ù‚ÙŠØ© Ø§Ù„Ù…Ø§Ø¯Ø©
} else if (
  data.status === "PREREQ_REQUIRED" ||   // Ø§Ù„Ù„ÙŠ ÙŠØ±Ø¬Ø¹Ù‡ Code.gs
  data.status === "PREREQ_MISSING"       // Ù†Ø®Ù„ÙŠÙ‡Ø§ Ø§Ø­ØªÙŠØ§Ø· Ù„Ùˆ ØªØºÙŠØ±Øª Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹
) {
  const pc = data.prereq_code || "";
  const pn = data.prereq_name || "";
  msg.textContent = `âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ³Ø¬ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø© Ù‚Ø¨Ù„ Ø§Ø¬ØªÙŠØ§Ø² Ù…Ø§Ø¯Ø© Ø§Ù„Ø£Ø³Ø¨Ù‚ÙŠØ©: ${pc} - ${pn}`;

      // â­ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ù‚ÙÙˆÙ„
      } else if (data.status === "SYSTEM_CLOSED") {
        msg.textContent = "â›” Ø§Ù„Ù†Ø¸Ø§Ù… Ù…ØºÙ„Ù‚ Ø­Ø§Ù„ÙŠØ§Ù‹ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ³Ø¬ÙŠÙ„ Ù…ÙˆØ§Ø¯.";
      } else {
        msg.textContent = "Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ØŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯. (Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø±Ø¯ ÙÙŠ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø£Ø³ÙˆØ¯)";
      }
    } catch (e) {
      console.error(e);
      msg.textContent = "âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ API";
    }
  }

  window.addEventListener("DOMContentLoaded", () => {
    loadCoursesList();
    loadStudentsList();

    const sidInput  = document.getElementById("sid");
    const codeInput = document.getElementById("code");

    sidInput.addEventListener("change", validateStudentFromInput);
    sidInput.addEventListener("blur",   validateStudentFromInput);

    codeInput.addEventListener("input",  updateCourseNameFromInput);
    codeInput.addEventListener("change", updateCourseNameFromInput);
    codeInput.addEventListener("blur",   updateCourseNameFromInput);
  });
</script>

</body>
</html>
